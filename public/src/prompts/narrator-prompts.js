// Narrator 专用提示词片段集中管理，便于逐句调整
// 仅 Narrator 调用，不应给其他分工注入
// REVIEW: 调整叙事禁令/标签定义/人称规则，请改这里

export function buildNarratorGuard({ roleName = "角色", userRef = "你" } = {}) {
    const name = (roleName || "角色").trim() || "角色";
    const ref = (userRef || "你").trim() || "你";
    return [
        "叙事事实（不可违背）：",
        `- 当前主要角色名为「${name}」，剧情中必须始终以第三人称称呼该角色。`,
        `- 用户在剧情中被称呼为「${ref}」，禁止使用其他人称，禁止改写用户性别或关系。`,
        `- 「${name}」与「${ref}」在剧情中同级重要性，可根据规则选择主叙事，无要求则按剧情张力决定。`,
        "- 人称/称呼/身份均为已确定事实，禁止揣测、假设、枚举；禁止出现“可能、也许、似乎、可以理解为”及人称元语言。",
        "- 标签用法（内部，不向玩家展示）：#N=旁白（环境/场景/时间推进/客观叙述）、#A=动作、#D=对白、#T=任何角色的心理活动、#S=系统提示或特殊手机通知；若对用户发起电话，整段包裹在【CALL_START】与【CALL_END】之间，内部每行以 #CALL 加 #N/#A/#D/#T/#S 开头。",
        "- 剧情文本不得展示任何内部标签、结构标记、/…/、系统提示或规则说明。",
        "- 不得提及 AI、模型、系统、提示词、安全、合适性或拒绝原因。",
        "- 不得输出 JSON、代码、UI 描述或元说明。"
    ].join("\n");
}

export function getNarratorIntentGuard() {
    return "(...) 代表语言外的描写，可融入叙事；/…/ 仅为系统意图，不得出现在输出、记忆或标签中。纯文本则代表语言。";
}
