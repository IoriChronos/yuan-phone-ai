<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Yuan · Story & Phone</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<div id="app">
    <!-- 剧情主面板 -->
    <section id="story-panel">
        <header id="story-header">
            <div class="story-title"></div>
            <div class="story-subtitle">轨迹 • He Loves You. The World Fears Him.</div>
        </header>
        <div id="character-sheet" class="character-sheet" aria-hidden="true">
            <div class="sheet-inner">
                <button id="character-sheet-close" type="button">收合</button>
                <h3>角色档案 · 元书</h3>
                <p>身影固定在城市的霓虹下，习惯以低沉的宣告和缓慢的呼吸控制一切。如同黑雾的代理人，记得每一次心跳、每一条规则。</p>
                <p>喜好：靠近、降温、热牛奶、泡芙。<br>禁忌：被忽视、未经允许的逃离。</p>
                <p>提示：若他说“别浪费时间”，代表剧情正在推进到更危险的阶段。</p>
            </div>
        </div>
        <main id="story-log">
            <!-- 之后由 JS 填充对话气泡 -->
        </main>
        <footer id="story-input-row">
            <button id="input-collapse-btn" class="hidden">⌄</button>
            <textarea id="story-input" rows="2" placeholder="在这里输入给元书的话…"></textarea>
            <div class="story-tools">
                <button id="story-tools-btn" class="story-tools-toggle" aria-label="更多工具">
                    <span class="tool-bar top"></span>
                    <span class="tool-bar middle"></span>
                    <span class="tool-bar bottom"></span>
                </button>
                <div id="story-tools-menu" class="story-tools-menu" aria-hidden="true">
                    <div class="menu-group menu-primary">
                        <div class="menu-head">常用操作</div>
                        <div class="menu-row">
                            <button id="story-tool-system">
                                <span class="icon-system"></span>
                                <span>System Prompt</span>
                            </button>
                        </div>
                        <div class="menu-row">
                            <label class="text-size-control">
                                <span class="text-size-label">Text Size</span>
                                <input id="story-font-slider" type="range" min="12" max="18" value="13">
                                <span id="story-font-value">13px</span>
                            </label>
                        </div>
                    </div>
                    <div class="menu-divider" aria-hidden="true"></div>
                    <div class="menu-group menu-secondary">
                        <div class="menu-head">重启</div>
                        <div class="menu-row">
                            <button id="story-tool-restart">
                                <span class="icon-restart"></span>
                                <span>Restart</span>
                            </button>
                        </div>
                        <div class="menu-hint">Story / Phone / All</div>
                    </div>
                    <div class="menu-divider" aria-hidden="true"></div>
                    <div class="menu-group menu-tertiary">
                        <div class="menu-head">高级联动</div>
                        <div class="menu-row">
                            <div class="provider-control">
                                <span>Provider</span>
                                <select id="ai-provider-select"></select>
                            </div>
                        </div>
                        <div class="menu-row">
                            <label class="memory-limit-control">
                                <span class="memory-label">Long Memory</span>
                                <input id="long-memory-slider" type="range" min="1" max="12" value="3">
                                <span id="long-memory-value" class="memory-value">3</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            <button id="story-send" class="click-anim" >发送</button>
        </footer>
        <div id="restart-sheet" class="restart-sheet" aria-hidden="true">
            <div class="sheet-content">
                <p>重启范围</p>
                <button data-restart="story">重置剧情记忆</button>
                <button data-restart="phone">重置手机数据</button>
                <button data-restart="all">重置全部</button>
                <button data-restart="cancel" class="ghost">取消</button>
            </div>
        </div>
        <div id="story-edit-sheet" class="story-edit-sheet" aria-hidden="true">
            <div class="edit-panel">
                <p>编辑 AI 回复</p>
                <textarea id="story-edit-input" rows="4" placeholder="在这里修改这句回复…"></textarea>
                <div class="edit-actions">
                    <button id="story-edit-save" type="button">保存修改</button>
                    <button id="story-edit-cancel" type="button" class="ghost">取消</button>
                </div>
            </div>
        </div>
    </section>

    <!-- 右侧手机区域（PC 上固定，手机上以弹层方式出现） -->
    <aside id="phone-layer">
        <div id="phone-shell" class="phone-pack">


                <div id="status-bar">
                    <div class="sb-left">
                        <div class="signal"></div>          
                        <div class="carrier">Yuan</div>
                        <div id="sb-time">08:18</div>   <!-- 时间放这里 -->
                    </div>
                    <div class="sb-right">
                        <div class="battery">
                            <div class="battery-level" id="bat-level"></div>
                        </div>
                    </div>
                </div>
                <div id="dynamic-island" class="collapsed">
                    <div class="island-content">···</div>
                    <div class="island-call" id="island-call" aria-hidden="true">
                        <div class="island-call-name" id="island-call-name">未知来电</div>
                        <div class="island-call-actions">
                            <button class="pixel-btn decline" data-call-action="decline">✕</button>
                            <button class="pixel-btn accept" data-call-action="accept">✓</button>
                        </div>
                    </div>
                    <div class="unlock-ring"></div>
                    <div class="unlock-face">🙂</div>
                    <div class="unlock-check">✅</div>
                </div>
                <div id="message-banner" aria-hidden="true">
                    <div class="message-banner-title" id="message-banner-title">元书</div>
                    <div class="message-banner-text" id="message-banner-text">···</div>
                </div>
            <div id="phone">


                <!-- 首页：图标 -->
                <div id="home-screen">
                    <div class="app-icon" data-target="wechat-page">
                        <div class="icon"></div>
                        <p>微信</p>
                    </div>
                    <div class="app-icon" data-target="call-page">
                        <div class="icon"></div>
                        <p>电话</p>
                    </div>
                    <div class="app-icon" data-target="darkfog-page">
                        <div class="icon"></div>
                        <p>黑雾</p>
                    </div>
                    <div class="app-icon" data-target="watch-page">
                        <div class="icon"></div>
                        <p>守望</p>
                    </div>
                    <div class="app-icon" data-target="memo-page">
                        <div class="icon"></div>
                        <p>备忘录</p>
                    </div>
                    <div class="app-icon" data-target="heart-page">
                        <div class="icon"></div>
                        <p>心率</p>
                    </div>
                    <div class="app-icon" data-target="settings-page">
                        <div class="icon"></div>
                        <p>设置</p>
                    </div>
                </div>

                <!-- 微信页面 -->
                <div id="wechat-page" class="app-page" style="display:none;">
                    <div class="page-header">
                        <button class="back-home">‹</button>
                        <div class="chat-window-head" id="chat-head-controls" style="display:none;">
                            <button id="chat-back" aria-label="返回">‹</button>
                            <button id="chat-recall-btn" class="chat-recall-btn" aria-label="撤回上一条" style="display:none;">撤回</button>
                            <span class="chat-unread-total" id="chat-unread-total" style="display:none;"></span>
                        </div>
                        <div class="wechat-top" id="wechat-top">Wechat (3)</div>
                    </div>
                    <div class="app-scroll wechat-body">
                        <div class="wechat-content">
                            <div class="wechat-panel" id="wechat-chats"></div>
                            <div class="wechat-panel wechat-moments-wrap" id="wechat-moments" style="display:none;">
                                <div class="moments-hero">
                                    <div class="moments-cover"></div>
                                    <div class="moments-avatar"></div>
                                </div>
                                <div class="moment-composer" id="moment-composer">
                                    <textarea id="moment-composer-input" rows="2" placeholder="发一条朋友圈…"></textarea>
                                    <div class="moment-composer-actions">
                                        <button id="moment-composer-send">发布</button>
                                    </div>
                                </div>
                                <div class="moments-feed-inner" id="wechat-moments-feed"></div>
                            </div>
                            <div class="wechat-panel" id="wechat-wallet" style="display:none;">
                                <div class="wallet-balance">
                                    <div class="label">零钱</div>
                                    <div class="value" id="wallet-balance-amt">¥ 2,180.00</div>
                                    <div class="sub">最近到账：来自「元书」¥1314.00</div>
                                </div>
                                <div class="wallet-actions" id="wallet-actions"></div>
                            </div>
                            <div class="wechat-chat-window" id="wechat-chat-window" style="display:none;">
                                <div class="chat-window-log" id="wechat-chat-log"></div>
                                <div class="chat-window-input">
                                    <button id="chat-actions-toggle" aria-label="更多功能">＋</button>
                                    <input id="wechat-chat-input" placeholder="输入消息…" />
                                    <button id="wechat-chat-send">发送</button>
                                </div>
                                <div class="chat-actions-panel" id="chat-actions-panel">
                                    <div class="chat-actions-buttons" id="chat-actions-buttons">
                                        <button data-chataction="pay">转账</button>
                                        <button data-chataction="red">红包</button>
                                    </div>
                                    <div class="chat-action-form" id="chat-action-form">
                                        <div class="chat-action-display" id="chat-action-display">¥0.00</div>
                                        <div class="chat-action-keypad" id="chat-action-keypad"></div>
                                        <div class="chat-action-form-buttons">
                                            <button id="chat-action-confirm">确认</button>
                                            <button id="chat-action-cancel" type="button">取消</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="wechat-tabs wechat-bottom-tabs" id="wechat-bottom">
                            <button data-wtab="chats" class="active">聊天</button>
                            <button data-wtab="moments">朋友圈</button>
                            <button data-wtab="wallet">钱包</button>
                        </div>
                    </div>
                </div>

                <!-- 电话页面 -->
                <div id="call-page" class="app-page" style="display:none;">
                    <div class="page-header">
                        <button class="back-home">‹</button>
                    </div>
                    <div class="page-body app-scroll">
                        <div class="call-tabs">
                            <button data-ctab="history" class="active">通话记录</button>
                            <button data-ctab="contacts">联系人</button>
                            <button data-ctab="keypad">拨号</button>
                        </div>
                        <div class="call-panel" id="call-history"></div>
                        <div class="call-panel" id="call-contacts" style="display:none;"></div>
                        <div class="call-panel" id="call-keypad" style="display:none;">
                            <div class="dial-display" id="dial-display">输入号码…</div>
                            <div class="dial-grid" id="dial-grid"></div>
                            <button class="dial-call" id="dial-call">拨打</button>
                        </div>
                    </div>
                </div>

                <!-- 黑雾页面 -->
                <div id="darkfog-page" class="app-page" style="display:none;">
                    <div class="page-header">
                        <button class="back-home">‹</button>
                        <span>黑雾</span>
                    </div>
                    <div class="page-body">
                        <p>这里以后可以做黑雾调度、压迫感控制面板。</p>
                    </div>
                </div>

                <!-- 守望页面 -->
                <div id="watch-page" class="app-page" style="display:none;">
                    <div class="page-header">
                        <button class="back-home">‹</button>
                        <span>守望</span>
                    </div>
                    <div class="page-body">
                        <p>这里以后可以做定位、投影、痕迹记录。</p>
                    </div>
                </div>

                <!-- 备忘录页面 -->
                <div id="memo-page" class="app-page" style="display:none;">
                    <div class="page-header">
                        <button class="back-home">‹</button>
                        <span>备忘录</span>
                    </div>
                    <div class="app-scroll memo-body">
                        <div class="memo-controls">
                            <button id="memo-clear">清空</button>
                        </div>
                        <div class="memo-log" id="memo-log"></div>
                    </div>
                </div>

                <!-- 心率页面 -->
                <div id="heart-page" class="app-page" style="display:none;">
                    <div class="page-header">
                        <button class="back-home">‹</button>
                        <span>心率</span>
                    </div>
                    <div class="page-body">
                        <p>这里以后接你的心率小游戏。</p>
                    </div>
                </div>

                <!-- 设置页面 -->
                <div id="settings-page" class="app-page" style="display:none;">
                    <div class="page-header">
                        <button class="back-home">‹</button>
                    </div>
                    <div class="page-body app-scroll">
                        <div class="card-block">壁纸 · 默认</div>
                        <div class="card-block">AI 模型 · 待接入</div>
                        <div class="card-block">记忆清单 · 0 条</div>
                    </div>
                </div>
            </div>
            <div id="red-envelope-overlay" aria-hidden="true">
                <div class="red-envelope-card">
                    <div class="red-envelope-title">红包</div>
                    <div class="red-envelope-amount" id="red-envelope-amount">¥0.00</div>
                    <div class="red-envelope-note">点击领取即可拆开红包</div>
                    <button id="red-envelope-confirm">领取</button>
                </div>
            </div>
            <div id="in-call-overlay" aria-hidden="true">
                <div class="in-call-card">
                    <div class="in-call-name" id="in-call-name">元书</div>
                    <div class="in-call-status" id="in-call-status">来电中…</div>
                    <div class="in-call-timer" id="in-call-timer">00:00</div>
                    <div class="in-call-transcript" id="in-call-transcript"></div>
                    <button id="in-call-end">挂断</button>
                </div>
            </div>
            <div id="home-bar"></div>
        </div>
    </aside>
</div>

<!-- 悬浮手机按钮 -->
<button id="phone-toggle" aria-label="打开手机">
    <div class="pixel-phone">
        <div class="pixel-screen"></div>
    </div>
    <div id="phone-toggle-bubble">新消息</div>
</button>

<script type="module" src="script.js"></script>
</body>
</html>
